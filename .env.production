# =============================================================================
# SaaS Multi-Tenant Backend Platform - Production Environment Template
# =============================================================================
# CRITICAL: This is a TEMPLATE for production settings
# Copy this file and fill in SECURE values for production deployment
# NEVER commit actual production credentials to version control!
#
# Security Checklist:
# [ ] Replace ALL placeholder values with secure production values
# [ ] Generate strong random secrets (use: python -c "import secrets; print(secrets.token_urlsafe(32))")
# [ ] Use strong database passwords (16+ chars, mixed case, numbers, symbols)
# [ ] Enable SSL/TLS for all connections
# [ ] Restrict CORS origins to production domains only
# [ ] Set up proper logging and monitoring
# [ ] Configure backup strategy
# [ ] Review all security settings before deployment
# =============================================================================

# -----------------------------------------------------------------------------
# Flask Application Settings
# -----------------------------------------------------------------------------
FLASK_APP=run.py
FLASK_ENV=production
FLASK_DEBUG=0
FLASK_PORT=4999
# CRITICAL: Generate a strong secret key for production!
# Example: python -c "import secrets; print(secrets.token_urlsafe(64))"
SECRET_KEY=REPLACE_WITH_SECURE_SECRET_KEY_MINIMUM_32_CHARACTERS

# -----------------------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------------------
# CRITICAL: Use strong passwords and SSL connections in production!
# Format: postgresql://username:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://PRODUCTION_DB_USER:STRONG_PASSWORD_HERE@db.example.com:5432/saas_platform?sslmode=require
DATABASE_POOL_SIZE=20
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=1800
DATABASE_MAX_OVERFLOW=40
DATABASE_ECHO=false

# Tenant database connection template
# Use same credentials and SSL settings as main database
TENANT_DATABASE_URL_TEMPLATE=postgresql://PRODUCTION_DB_USER:STRONG_PASSWORD_HERE@db.example.com:5432/{database_name}?sslmode=require

# -----------------------------------------------------------------------------
# JWT Authentication Settings
# -----------------------------------------------------------------------------
# CRITICAL: Generate a strong JWT secret key!
# Example: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET_KEY=REPLACE_WITH_SECURE_JWT_SECRET_MINIMUM_64_CHARACTERS
JWT_ACCESS_TOKEN_EXPIRES=900
JWT_REFRESH_TOKEN_EXPIRES=604800
JWT_ALGORITHM=HS256

# -----------------------------------------------------------------------------
# Kafka Configuration
# -----------------------------------------------------------------------------
# Use production Kafka cluster with authentication
KAFKA_BOOTSTRAP_SERVERS=kafka-1.prod.example.com:9092,kafka-2.prod.example.com:9092,kafka-3.prod.example.com:9092
KAFKA_CLIENT_ID=saas-platform-prod
KAFKA_CONSUMER_GROUP_ID=saas-consumer-group-prod
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=true
KAFKA_MAX_POLL_RECORDS=500
KAFKA_ACKS=all
KAFKA_RETRIES=5
KAFKA_COMPRESSION_TYPE=snappy
KAFKA_MAX_IN_FLIGHT_REQUESTS=5

# Kafka Security (if using SASL/SSL)
# KAFKA_SECURITY_PROTOCOL=SASL_SSL
# KAFKA_SASL_MECHANISM=PLAIN
# KAFKA_SASL_USERNAME=KAFKA_USER
# KAFKA_SASL_PASSWORD=KAFKA_PASSWORD

# Kafka Topics
KAFKA_TOPIC_TENANT_CREATED=tenant.created
KAFKA_TOPIC_TENANT_DELETED=tenant.deleted
KAFKA_TOPIC_DOCUMENT_UPLOADED=document.uploaded
KAFKA_TOPIC_DOCUMENT_DELETED=document.deleted
KAFKA_TOPIC_FILE_PROCESS=file.process
KAFKA_TOPIC_AUDIT_LOG=audit.log

# -----------------------------------------------------------------------------
# S3 Configuration (AWS S3 or Compatible Service)
# -----------------------------------------------------------------------------
# For AWS S3: Use IAM roles or secure credentials
S3_ENDPOINT_URL=
S3_ACCESS_KEY_ID=REPLACE_WITH_AWS_ACCESS_KEY_ID
S3_SECRET_ACCESS_KEY=REPLACE_WITH_AWS_SECRET_ACCESS_KEY
S3_BUCKET=saas-platform-production-documents
S3_REGION=us-east-1
S3_USE_SSL=true

# Optional: S3-compatible service (MinIO, DigitalOcean Spaces, etc.)
# S3_ENDPOINT_URL=https://s3.example.com
# S3_SIGNATURE_VERSION=s3v4

# -----------------------------------------------------------------------------
# CORS Configuration (Restrict to Production Domains)
# -----------------------------------------------------------------------------
# CRITICAL: Only allow requests from production domains!
CORS_ORIGINS=https://app.example.com,https://www.example.com
CORS_SUPPORTS_CREDENTIALS=true
CORS_MAX_AGE=3600
CORS_ALLOW_HEADERS=Content-Type,Authorization
CORS_EXPOSE_HEADERS=Content-Type,Authorization
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH

# -----------------------------------------------------------------------------
# Logging Configuration (Production Level)
# -----------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s - [%(pathname)s:%(lineno)d]
LOG_FILE=logs/app.log
LOG_MAX_BYTES=52428800
LOG_BACKUP_COUNT=10

# External logging (Sentry, CloudWatch, etc.)
# SENTRY_DSN=https://YOUR_SENTRY_DSN@sentry.io/PROJECT_ID
# SENTRY_ENVIRONMENT=production
# SENTRY_RELEASE=1.0.0

# -----------------------------------------------------------------------------
# Rate Limiting (Enable for Production)
# -----------------------------------------------------------------------------
RATELIMIT_ENABLED=true
RATELIMIT_STORAGE_URL=redis://redis.prod.example.com:6379/0
RATELIMIT_DEFAULT=100/hour
RATELIMIT_HEADERS_ENABLED=true

# API-specific rate limits
RATELIMIT_LOGIN=5/minute
RATELIMIT_REGISTER=3/hour
RATELIMIT_UPLOAD=20/minute

# -----------------------------------------------------------------------------
# Redis Configuration (Required for Production)
# -----------------------------------------------------------------------------
# Use Redis for caching, sessions, and rate limiting
REDIS_URL=redis://redis.prod.example.com:6379/0
REDIS_PASSWORD=REPLACE_WITH_REDIS_PASSWORD
REDIS_DB=0
REDIS_MAX_CONNECTIONS=50
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# Cache configuration
CACHE_TYPE=redis
CACHE_REDIS_URL=redis://:REPLACE_WITH_REDIS_PASSWORD@redis.prod.example.com:6379/1
CACHE_DEFAULT_TIMEOUT=300

# -----------------------------------------------------------------------------
# Application Settings
# -----------------------------------------------------------------------------
MAX_CONTENT_LENGTH=104857600
UPLOAD_FOLDER=/var/app/uploads
ALLOWED_EXTENSIONS=pdf,doc,docx,txt,png,jpg,jpeg,gif,csv,xlsx

# -----------------------------------------------------------------------------
# Security Settings
# -----------------------------------------------------------------------------
# Force HTTPS
PREFERRED_URL_SCHEME=https
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax

# Content Security Policy
CSP_ENABLED=true
CSP_REPORT_URI=https://example.com/csp-report

# HSTS (HTTP Strict Transport Security)
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true

# -----------------------------------------------------------------------------
# Email Configuration (Production SMTP)
# -----------------------------------------------------------------------------
MAIL_SERVER=smtp.example.com
MAIL_PORT=587
MAIL_USE_TLS=true
MAIL_USERNAME=noreply@example.com
MAIL_PASSWORD=REPLACE_WITH_SMTP_PASSWORD
MAIL_DEFAULT_SENDER=SaaS Platform <noreply@example.com>

# SendGrid, Mailgun, or other email service
# SENDGRID_API_KEY=REPLACE_WITH_SENDGRID_API_KEY
# MAILGUN_API_KEY=REPLACE_WITH_MAILGUN_API_KEY
# MAILGUN_DOMAIN=mg.example.com

# -----------------------------------------------------------------------------
# Monitoring & Observability
# -----------------------------------------------------------------------------
# APM (Application Performance Monitoring)
# NEW_RELIC_LICENSE_KEY=REPLACE_WITH_NEW_RELIC_KEY
# NEW_RELIC_APP_NAME=SaaS Platform Production

# DataDog APM
# DD_AGENT_HOST=datadog-agent.prod.example.com
# DD_TRACE_ENABLED=true
# DD_SERVICE=saas-platform
# DD_ENV=production

# Prometheus metrics
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=8000

# -----------------------------------------------------------------------------
# Backup & Disaster Recovery
# -----------------------------------------------------------------------------
# Automated backup configuration
BACKUP_ENABLED=true
BACKUP_S3_BUCKET=saas-platform-backups
BACKUP_RETENTION_DAYS=30
BACKUP_SCHEDULE=0 2 * * *

# -----------------------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------------------
FEATURE_DOCUMENT_OCR=true
FEATURE_DOCUMENT_THUMBNAILS=true
FEATURE_EMAIL_NOTIFICATIONS=true
FEATURE_AUDIT_LOGGING=true

# -----------------------------------------------------------------------------
# Third-Party Integrations
# -----------------------------------------------------------------------------
# OAuth Providers (if needed)
# GOOGLE_CLIENT_ID=
# GOOGLE_CLIENT_SECRET=
# GITHUB_CLIENT_ID=
# GITHUB_CLIENT_SECRET=

# Payment Processing (if needed)
# STRIPE_PUBLISHABLE_KEY=
# STRIPE_SECRET_KEY=
# STRIPE_WEBHOOK_SECRET=

# -----------------------------------------------------------------------------
# Production Deployment Settings
# -----------------------------------------------------------------------------
WORKERS=4
WORKER_CLASS=sync
WORKER_TIMEOUT=120
WORKER_MAX_REQUESTS=1000
WORKER_MAX_REQUESTS_JITTER=50

# Gunicorn settings
GUNICORN_BIND=0.0.0.0:4999
GUNICORN_WORKERS=4
GUNICORN_THREADS=2
GUNICORN_WORKER_CONNECTIONS=1000
GUNICORN_KEEPALIVE=5

# =============================================================================
# DEPLOYMENT CHECKLIST
# =============================================================================
# Before deploying to production, ensure:
# [ ] All REPLACE_WITH_* values have been replaced with secure values
# [ ] Strong passwords used (16+ characters, mixed case, numbers, symbols)
# [ ] SSL/TLS enabled for all connections
# [ ] CORS origins restricted to production domains only
# [ ] Rate limiting enabled with Redis
# [ ] Logging configured with external service (Sentry, CloudWatch)
# [ ] Monitoring and alerting set up
# [ ] Backup strategy tested and verified
# [ ] Security headers configured (CSP, HSTS)
# [ ] Email service configured and tested
# [ ] Database connection pooling optimized for load
# [ ] Kafka cluster configured with replication
# [ ] S3 bucket policies configured correctly
# [ ] Environment variables loaded securely (not hardcoded)
# [ ] Secrets management solution in place (AWS Secrets Manager, Vault)
# [ ] Load balancer configured with health checks
# [ ] Auto-scaling policies configured
# [ ] Disaster recovery plan documented
# =============================================================================
