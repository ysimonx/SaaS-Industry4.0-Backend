# Docker Compose Environment Variables - MINIMAL (For Vault Setup)
# This file contains ONLY non-secret configuration variables
# All secrets are managed by HashiCorp Vault
# DO NOT add sensitive data to this file

# ============================================================================
# Flask Configuration
# ============================================================================
FLASK_ENV=development
FLASK_APP=run.py
FLASK_DEBUG=1
FLASK_PORT=4999

# ============================================================================
# Database Configuration (NON-SECRET)
# ============================================================================
# Note: Connection strings with credentials are stored in Vault
# These are just pool configuration settings
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_ECHO=false

# ============================================================================
# JWT Configuration (NON-SECRET)
# ============================================================================
# Note: JWT_SECRET_KEY is stored in Vault
JWT_ACCESS_TOKEN_EXPIRES=900
JWT_REFRESH_TOKEN_EXPIRES=604800
JWT_ALGORITHM=HS256

# ============================================================================
# Kafka Configuration (NON-SECRET)
# ============================================================================
KAFKA_BOOTSTRAP_SERVERS=kafka:9092
KAFKA_CLIENT_ID=saas-platform
KAFKA_CONSUMER_GROUP_ID=saas-consumer-group
KAFKA_AUTO_OFFSET_RESET=earliest
KAFKA_ENABLE_AUTO_COMMIT=true
KAFKA_MAX_POLL_RECORDS=100
KAFKA_ACKS=all
KAFKA_RETRIES=3
KAFKA_COMPRESSION_TYPE=gzip

# ============================================================================
# S3 Configuration (NON-SECRET)
# ============================================================================
# Note: S3_ACCESS_KEY_ID and S3_SECRET_ACCESS_KEY are stored in Vault
S3_ENDPOINT_URL=http://minio:9000          # Internal URL (backend → MinIO)
S3_PUBLIC_URL=http://localhost:9000        # Public URL (client → MinIO)
S3_BUCKET=saas-documents
S3_REGION=us-east-1
S3_USE_SSL=false

# ============================================================================
# CORS Configuration
# ============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:4999
CORS_SUPPORTS_CREDENTIALS=true
CORS_MAX_AGE=3600

# ============================================================================
# Logging Configuration
# ============================================================================
LOG_LEVEL=DEBUG
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_FILE=logs/app.log
LOG_MAX_BYTES=10485760
LOG_BACKUP_COUNT=5

# ============================================================================
# Rate Limiting (Optional - requires Redis)
# ============================================================================
# RATELIMIT_ENABLED=false
# RATELIMIT_STORAGE_URL=redis://redis:6379/0
# RATELIMIT_DEFAULT=100/hour


# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_URL=redis://redis:6379/0
REDIS_MAX_CONNECTIONS=20
REDIS_DECODE_RESPONSES=true


# ============================================================================
# Celery Configuration
# ============================================================================
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=json
CELERY_TIMEZONE=UTC
CELERY_ENABLE_UTC=true
CELERY_TASK_TRACK_STARTED=true
CELERY_TASK_TIME_LIMIT=300
CELERY_TASK_SOFT_TIME_LIMIT=240


# ============================================================================
# Application Settings
# ============================================================================
MAX_CONTENT_LENGTH=104857600
UPLOAD_FOLDER=uploads
ALLOWED_EXTENSIONS=pdf,doc,docx,txt,png,jpg,jpeg,gif

# ============================================================================
# Development Tools
# ============================================================================
# Set to true to enable SQL query logging
SQL_DEBUG=false

# Set to true to enable Flask toolbar (requires flask-debugtoolbar)
FLASK_TOOLBAR_ENABLED=false

# ============================================================================
# Monitoring Configuration
# ============================================================================
# Main Healthchecks.io configuration is in .env.healthchecks
# These core values are needed by the API services:
HEALTHCHECKS_ENABLED=true
HEALTHCHECKS_API_URL=http://healthchecks:8000/api/v1
HEALTHCHECKS_PING_URL=http://healthchecks:8000/ping
HEALTHCHECKS_API_KEY=hVIB-d9ihVotUKFmoiwAKNH5JBVmra4j
HEALTHCHECKS_READ_KEY=MoT6b6wH1mAdzuUdDiMQyvGq01ETFuzn

# ============================================================================
# SECRETS ARE MANAGED BY VAULT
# ============================================================================
# The following secrets are NOT in this file and are retrieved from Vault:
# - DATABASE_URL
# - TENANT_DATABASE_URL_TEMPLATE
# - JWT_SECRET_KEY
# - S3_ACCESS_KEY_ID
# - S3_SECRET_ACCESS_KEY
#
# These are automatically loaded by the application from Vault at runtime
# See vault/init-data/docker.env for the secrets injected into Vault
# ============================================================================
